# 🗄️ 数据库迁移指南

## 📋 迁移方案
- 保持数据库名称: `js_editor`
- 保持用户: `root`
- 保持现有配置不变

## 🎯 迁移步骤

### 方案一：从开发环境导出数据 (推荐)

#### 第一步：在开发机器上导出数据
```cmd
# 导出完整数据库 (结构+数据)
mysqldump -u root -p520 js_editor > js_editor_full_backup.sql

# 或者只导出结构 (如果不需要现有数据)
mysqldump -u root -p520 --no-data js_editor > js_editor_structure.sql
```

#### 第二步：将SQL文件上传到服务器
将生成的 `.sql` 文件上传到服务器项目目录

#### 第三步：在服务器上导入数据
```cmd
# 1. 连接MySQL并创建数据库
mysql -u root -p
```

```sql
-- 创建数据库 (如果不存在)
CREATE DATABASE IF NOT EXISTS js_editor CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE js_editor;
```

```cmd
# 2. 退出MySQL并导入数据
exit

# 3. 导入完整备份
mysql -u root -p js_editor < js_editor_full_backup.sql
```

### 方案二：使用项目中的SQL脚本

#### 第一步：创建数据库
```cmd
mysql -u root -p
```

```sql
CREATE DATABASE IF NOT EXISTS js_editor CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE js_editor;
exit;
```

#### 第二步：按顺序执行SQL脚本
```cmd
# 进入backend目录
cd backend

# 1. 导入基础表结构
mysql -u root -p js_editor < init_data.sql

# 2. 创建课件表
mysql -u root -p js_editor < create_courseware_table.sql

# 3. 创建问答表
mysql -u root -p js_editor < create_qa_table.sql

# 4. 创建通知表
mysql -u root -p js_editor < setup_notifications_simple.sql

# 5. 添加用户字段
mysql -u root -p js_editor < add_user_fields.sql

# 6. 修复重做字段
mysql -u root -p js_editor < fix_redo_column.sql

# 7. 创建锚点表
node init-anchor-tables.js
```

### 方案三：自动化迁移脚本

我为你创建一个自动化脚本：