# 课件锚点功能使用说明

## 功能概述

课件锚点功能允许教师在PPT课件的特定位置标记知识点，并为每个知识点关联多种类型的学习资源，实现沉浸式教学体验。

## 主要功能

### 1. 锚点标记
- 在PPT幻灯片的任意位置点击添加知识点锚点
- 为锚点设置名称和描述
- 精确定位锚点位置（支持百分比坐标）

### 2. 资源关联
每个锚点可以关联三种类型的资源：

#### 视频资源
- **外部链接**: 支持B站、YouTube等视频平台链接
- **本地上传**: 支持上传MP4、AVI、MOV等格式视频文件
- **文件限制**: 单个视频文件最大500MB

#### 代码示例
- 添加与知识点相关的代码片段
- 支持语法高亮显示
- 可用于演示编程概念和实例

#### 语法说明
- 添加知识点的详细语法说明
- 支持富文本格式
- 包含易错点和注意事项

### 3. 演示模式
- 全屏演示课件
- 实时显示当前页面的锚点
- 点击锚点跳转到相关资源
- 支持返回原演示位置

## 使用步骤

### 第一步：数据库初始化
```bash
cd backend
node init-anchor-tables.js
```

### 第二步：上传PPT课件
1. 在教师仪表盘选择"课件管理"
2. 点击"上传课件"按钮
3. 选择PPT或PPTX文件并填写相关信息
4. 等待上传完成

### 第三步：添加锚点
1. 在课件列表中找到已上传的PPT文件
2. 点击"锚点"按钮进入锚点编辑器
3. 在幻灯片上点击要添加锚点的位置
4. 填写锚点名称和描述
5. 点击"保存"完成锚点创建

### 第四步：关联资源
1. 在锚点列表中点击"添加资源"按钮
2. 选择资源类型（视频/代码/语法说明）
3. 填写资源内容：
   - **视频**: 输入B站链接或上传视频文件
   - **代码**: 输入代码内容
   - **语法说明**: 输入详细说明文本
4. 点击"添加资源"完成关联

### 第五步：开始演示
1. 在课件列表中点击"演示"按钮
2. 进入全屏演示模式
3. 使用键盘方向键或鼠标点击切换幻灯片
4. 点击红色锚点查看相关资源
5. 在资源页面点击"返回演示"回到原位置

## 技术特性

### 支持的文件格式
- **课件**: PPT, PPTX
- **视频**: MP4, AVI, MOV, WMV, WebM, MKV, FLV
- **最大文件大小**: 课件50MB，视频500MB

### 浏览器兼容性
- Chrome 80+
- Firefox 75+
- Safari 13+
- Edge 80+

### 响应式设计
- 支持不同屏幕尺寸
- 自适应布局
- 触摸设备友好

## API接口

### 锚点管理
```javascript
// 获取课件锚点
GET /api/courseware/:coursewareId/anchors

// 创建锚点
POST /api/anchors
{
  "courseware_id": 1,
  "slide_number": 1,
  "anchor_name": "CSS盒模型",
  "description": "介绍CSS盒模型的基本概念",
  "x_position": 50.0,
  "y_position": 30.0
}

// 更新锚点
PUT /api/anchors/:anchorId

// 删除锚点
DELETE /api/anchors/:anchorId
```

### 资源管理
```javascript
// 获取锚点资源
GET /api/anchors/:anchorId/resources

// 添加视频资源
POST /api/anchors/:anchorId/resources/video

// 添加代码资源
POST /api/anchors/:anchorId/resources/code

// 添加语法说明资源
POST /api/anchors/:anchorId/resources/syntax

// 删除资源
DELETE /api/resources/:resourceId
```

## 故障排除

### 常见问题

1. **课件预览失败**
   - 确保LibreOffice已正确安装
   - 检查ImageMagick是否可用
   - 验证PPT文件格式是否正确

2. **视频上传失败**
   - 检查文件大小是否超过限制
   - 确认视频格式是否支持
   - 验证网络连接是否稳定

3. **锚点不显示**
   - 刷新页面重新加载
   - 检查数据库连接
   - 确认锚点坐标是否正确

4. **演示模式异常**
   - 检查浏览器是否支持全屏API
   - 确认课件预览图片是否生成
   - 验证锚点数据是否完整

### 日志查看
```bash
# 后端日志
cd backend
npm run dev

# 前端控制台
F12 -> Console
```

## 更新日志

### v1.0.0 (2024-12-11)
- ✅ 基础锚点标记功能
- ✅ 视频资源关联（链接和上传）
- ✅ 代码示例资源
- ✅ 语法说明资源
- ✅ 演示模式
- ✅ 跳转闭环功能

### 计划功能
- 🔄 实时标注同步
- 🔄 投票互动系统
- 🔄 多媒体资源支持
- 🔄 学生端演示跟随

## 技术支持

如遇到问题，请检查：
1. 后端服务是否正常运行 (http://localhost:5000)
2. 数据库连接是否正常
3. 必要的系统依赖是否已安装

更多技术细节请参考 `教学演示工具实现方案.md`